\chapter{Data Application}
\section{Introduction}
Obesity has become one of the most burdensome public health issues of the time in the United States \cite{surgeon2001}.  This epidemic impacts children and adults alike.  A recent study estimates that about 32\% of children in the U.S. are overweight or obese \cite{ogden2008}. This alarming statistic has been a call to action for public officials and parents to change how we live and eat. However, encouraging healthy diets and physical activity through increased education and community involvement has own seen limited success.  It is generally accepted that genetic, metabolic, and environmental factors play a role in children's weight in addition to the behavioral factors. Yet, the exact determinants of childhood obesity are poorly understood.

It is difficult to change the behavior of individuals in a community. Recent focus has been on other potential causes and venues for intervention. Researchers hypothesize that exposure to hormone-altering chemicals may disrupt and reprogram the metabolical system to favor weight gain \cite{tuma2007}. Animal studies suggest that endocrine disrupters such as bisphenol A cause increased weight after adjusting for exercise and amount and type of food \cite{rubin2001,rubin2009}, but in human studies, there are only moderately significant associations found \cite{mendez2011} (see additional references within \cite{harley2013}.
 
 To fully understand the potential impact of chemical exposure on childhood growth development, it is necessary to observe the height and weight of children over the entire time frame between infancy and adolescence. Quality longitudinal growth studies are becoming more common, but most data analyses do not fully take advantage of the longitudinal nature of the data and only look at two cross-sectional points to determine change over time. Only in the past few years have researchers noted the important of the entire growth trajectory of individuals and attempt to study distinct trajectory patterns \cite{pryor2011,carter2012,li2007,garden2012}. 

\subsection{Body mass index trajectories}
Quantifying and evaluating children's growth is important task that involves measuring both weight and height. Body mass index (BMI), calculated as $weight (kg)/height^{2} (m^{2})$, is a weight-height index that in effect is a method of adjust weight for height. It is recommended as an indicator of total body fat for most individuals \cite{roche1981}. The Center for Disease Control (CDC) publishes clinical charts that include reference growth curves for BMI-for-age in terms of percentiles or BMI z-scores using pooled BMI data from cross-sectional National Health and Nutrition Examination Survey data (NHANES). The z-scores are not intended for longitudinal analysis as the CDC performs different normalizing transformations for each month to resolve the skewed sex and age-specific distributions for BMI. Since the reference data is cross-sectional, the charts may not reflect typical age-related patterns of BMI change. Therefore, we concentrate on the original BMI trajectories instead of BMI z-scores over time.

Researchers hypothesize that there are distinct growth patterns amongst children in the United States. One way to detect these patterns is by applying cluster analysis methods to childhood BMI trajectory data. Additional analysis is completed to estimate the relationship between maternal and early life factors and group membership. Early life factors such as maternal BMI, maternal smoking, maternal weight gain, maternal age, birth weight, and duration of breastfeeding have been suggested to be potential predictors of increased risk of a high-rising BMI growth as well as the early and late onset of obesity \cite{pryor2011,carter2012,li2007}.

\subsection{Clustering analysis}
The clustering methods used in many longitudinal applications including body mass index trajectories are typically based on a finite mixture model, which is a probabilistic model for representing subgroups within the overall population that occur with different frequencies but are not known a priori. In the simplest form, the mixture density for the random outcome vector is a weighted sum of $K$ group densities:
$$f(\B y|\bs\theta) = \sum^{K}_{k=1}\pi_{k}f_{k}(\B y|\bs\theta_{k})$$
where $\pi_{k}$ is the probability of belonging to the $k$th group ($C$) and $\pi_{k}>0$ for all $k=1,..,K$ and $\sum^{K}_{k=1}\pi_{k}=1$. The probability densities, $f_{k}$, are typically assumed to be multivariate Gaussian for continuous outcomes such as BMI. With longitudinal data, the main goal is to study the change over time so typically the mean for the groups will also be conditional on the observations times, $\B t.$  This model is the basis for many popular methods and software that have rapidly become commonplace in the growth trajectory literature.

The Proc Traj add-on package for SAS \cite{jones2001}, used frequently in the BMI literature \cite{pryor2011,carter2012}, fits group-based trajectory models such that for a continuous outcome measure, the group distributions are assumed to be multivariate Gaussian with a polynomial mean function and the repeated measures within an individual are independent conditional on the group membership. Thus, the outcome data $\B y_{i} = (y_{i1},...,y_{im_{i}})$ for subject $i$ at times $\B t_{i} = (t_{i1},t_{i2},...,t_{im_{i}})$, given subject $i$ belongs to group $k$, is assumed equal to
$$\B y_{i} = \beta_{0k}+\beta_{1k} \B t_{i} + \beta_{2k}\B t_{i}^{2}+ \beta_{3k} \B t_{i}^{3} + \epsilon_{i}$$
where $\epsilon_{i}\sim N(0,\sigma^{2}I)$. Additionally, the group probabilities can be modeled using a generalized logit function that allows time-stable covariates determine group membership (setting $\bs\gamma_{K}=0$ for identifiability),
$$\pi_{k}=\frac{\exp(\bs\gamma_{k}^{T}\B w_{i})}{\sum^{K}_{l=1}\exp(\bs\gamma_{l}^{T}\B w_{i})}$$
where $\B w_{i}$ is a design matrix based on time-stable covariates. 

Another software program, Mplus \cite{muthen2010}, commonly used in the literature \cite{li2007,garden2012}, fits a generalization of this model, termed a Growth Mixture Model, which allows random effects in the mean structure to account for within-class variation that is ignored in the Proc Traj model specification. Assuming a distribution for the cluster-specific slope and intercept coefficients attempts to model within-individual dependence that is inherent in repeated measures. Thus, observed data for subject $i$ is assumed equal to
$$\B y_{i} = \beta_{0k}+\beta_{1k} \B t_{i} + \beta_{2k}\B t_{i}^{2}+ \beta_{3k} \B t_{i}^{3} + \epsilon_{i}$$
where $\epsilon_{i}\sim N(0,\bs\Sigma_{ik})$. 
with $\bs\Sigma_{ik}=\Lambda_{i}\Psi_{k}\Lambda_{i}^{T}+\Theta_{k}$, where $\Theta_{k}$ is the covariance matrix of the random errors, $\Psi_{K}$ is the covariance matrix for the random effects, and $$\Lambda_{i}=\left(\begin{array}{cccc}1&t_{i1}&t_{i1}^{2}&t_{i1}^{3}\\ 1&\vdots&\vdots&\vdots\\ 1&t_{im_{i}}&t_{im_{i}}^{2}&t_{im_{i}}^{3} \end{array} \right)$$
This model is general enough to include Proc Traj specification by letting $\Psi_{k}=\B 0$ and $\Theta_{k}=\sigma^{2}I$ for all $k=1,...,K$. However, including random effects indirectly specifies a complex, non-stationary covariance structure, an assumption that is hard to check. This is problematic since misspecifying the covariance structure in finite multivariate Gaussian mixture models can cause bias in the mean estimates and an incorrect number of chosen groups as seen in Chapter 2. We recommend fitting a model using an well-known, stationary correlation structure such as exchangeable or exponential correlation before jumping to something more complex and non-stationary. Special attention should be paid to modeling the dependence inherent in repeated measures of an outcome over time.

These model-based methods are typically understood to group individuals such that members of the same group share a similar pattern of change over time \cite{garden2012}. This suggests that two individuals with similar patterns of change but different vertical levels would be grouped together. However, model parameters and subsequently group membership are estimated by maximizing a likelihood function which is based on the Euclidean distance between observed data and the mean vectors if normality is assumed (see Chapter 3). This process results in groups being primarily determined by the level despite subtle differences in the shape especially if the level and shape of a trajectory are independent or weakly dependent. Therefore, these methods as they are do not directly group trajectories on shape and resulting groups may include trajectories of the same level but different shapes over time. This translates into estimated group memberships and means not accurately representing shape groups present in the data.

Due to this misunderstanding, researchers present the results of a mixture model analysis by discussing the shape of the estimated mean trajectories for each group \cite{pryor2011,carter2012}. However, the mean only represents the average shape of all trajectories in that group; not everyone, perhaps no one, follows the path of the mean especially when the groups are not homogeneous in terms of shape. Additionally, the estimated relationships between risk factors and the resulting groups are deceitful values given the group descriptions can be inaccurate. Care needs to be taken when making conclusions based on these methods especially in describing the shape of the trajectories within each group.  

Given the clear goals of these papers were to group individuals on the basis of the shape of their growth trajectory, it is appropriate to compare the new methods proposed in Chapter 5 of this thesis. The vertically shifting mixture model is based on the same foundation as those described above. The main difference is that rather than fitting a model to the original data, the outcome is defined as the transformed or vertically shifted data vector. Each individual's mean BMI is subtracted from all of their measured BMI values. In effect, each individual is normalized to have mean zero and the level is removed without eliminating the variability at each time point. By removing the mean prior to fitting a multivariate Gaussian mixture model, we allow the clustering method to focus directly on the shape rather than the level. Thus, the resulting groups can be honestly summarized by describing the shape of the mean trajectory of the group and estimated associations with risk factors can be interpreted accurately in terms of shape groups. We illustrate these cautions with BMI data on a sample of Hispanic children.

\section{Methods}
\subsection{CHAMACOS}
The Center for the Health Assessment of Mothers and Children of Salinas (CHAMACOS) Study is a longitudinal birth cohort study designed to assess the health effects of pesticides and other environmental exposures on the growth and development in children living in the agricultural Salinas Valley, CA \cite{eskenazi2004,eskenazi2005}. Of 601 pregnant women enrolled in the study in 1999-2000, a title of 527 mother-child singleton pairs were followed through a live-birth delivery and 327 pairs continued to be followed through the 9-year visit. Baseline maternal characteristics were measured at the start of the study and maternal urine and blood samples were taken twice during pregnancy and then again shortly after delivery to measure levels of pesticide and chemical exposure. Child height and weight  were measured at interviews that occurred at birth and approximately 1, 2, 3 1/2, 5, 7, and 9 years old. BMI is calculated for ages 2 and up. For this paper, we limit our analysis to 303 children who have BMI measures available for at least four time points. Details of the study are published elsewhere \cite{eskenazi2003}. All study activities were approved by the Committee for the Protection of Human Subjects at the University of California, Berkeley. 

At each assessment point, children were weighed and measured without jackets and shoes by trained staff. BMI was calculated as weight (kg) divided by height squared ($m^{2}$). The exactly age of the child was also calculated due to variability in the interview times.

For illustrative purposes, we limit the discussion to a few baseline risk factors. One of the strongest known predictors of a child's BMI is the maternal pre-pregnancy BMI. At the start of the study, the maternal height was measured and used together with self-reported pre-pregnancy weight to calculate the BMI . During the first and second half of pregnancy, BPA concentration was measured in urine samples. See \textcite{harley2013} for details of how the concentrations were measured.

Characterizing BMI growth trajectories of children and whether there are distinct patterns is of great importance to public health officials. We use this data set to illustrate the differences between the clustering methods and how they work in practice with real data.

\subsection{Data analysis}
We use the standard and novel methods described in this thesis and compare the clustering groups and the inference on baseline factors that may be related to cluster membership. Specifically, we fit a multivariate Gaussian mixture with conditional independence like Proc Traj (Model 1), a multivariate Gaussian mixture with exponential correlation (Model 2), and the vertically shifting mixture model proposed in this thesis (Model 3).

All of these model-based methods require a mean structure. We used a B-spline basis to model the mean function. Based on the visual inspection of the data, we determine that quadratic basis functions with one internal knot should be sufficient to model the complexity given the limited number of time points.  The internal knot is place at the median observation time. 

To test the differences between the methods in terms of baseline factor relationships, we ran the model with two different factors: maternal pre-pregnancy BMI, which is known to impact the child's BMI, and log base 2 of maternal BPA exposure during pregnancy, which is hypothesized to impact growth trajectories. These are estimated separately from each other but simultaneously with the other model parameters.

To estimate parameters for all of the models, we use maximum likelihood estimation via the EM algorithm. We ran the algorithm for each model five times with random starts and chose the fit with the highest likelihood. For each model, the number of groups is chosen by fitting the models for $K=2,3,4,5,6$ and choosing the value of $K$ that minimizes the BIC. To make inferences about the parameters, we calculated the robust sandwich estimator \cite{white1982}. Odds ratios for baseline factors are calculated by exponentiating the coefficients and are presented with exponentiated confidence intervals.

The cluster groups are visualized by plotting individual BMI trajectories colored according to the group assignment made by maximizing the posterior probability. Then the group means are represented in the adjoining window. For the vertically shifted model, the group means are shifted such that the mean BMI at age 2 equals the average BMI for individuals in the particular group at age 2. 


\section{Results}
Figure \ref{fig:6-1} show the clustering results for the three mixture models using maternal pre-pregnancy BMI as a baseline factor impacts group membership. The chosen number of groups for each model is $K = 5$, $K=4$, and $K=4$ for Model 1, 2, and 3, respectively. Model 1 as compared to Model 2 requires more groups to model the variability within the BMI trajectories due to the limited correlation structure. Neither Model 1 or Model 2 group individuals based on the shape of their trajectories, but it is hard to see this without comparing the results to those from Model 3. The last clustering model highlights individuals with high BMI levels with relatively stable trajectories over time who were grouped with those that are drastically increasing over time for the other models. 

It is interesting to note that the mean shapes do not drastically change between Model 2 and Model 3 even though group memberships do change. Thus, the number of changes is not enough to change the shape of the means. Even though it is tempting to compare the starting levels of the mean curves, it is important to realize that the level was removed to focus on the shape in Model 3 and the artificial levels are based on the average BMI levels within the groups. Thus in Model 3, group 1 includes more individuals with lower BMI at age 2. (Give Adjusted Rand Index for match partition)

Table \ref{tab:6-1} gives the estimated odds ratios comparing group membership for the baseline factor, maternal pre-pregnancy BMI. Although the increasing trend occurs in the odds ratios for pre-pregnancy BMI, the inference depends on the model used. It is agreed upon that maternal pre-pregnancy BMI predicts the child's BMI level. However, it is interesting to note that generalizing the correlation structure ends up increasing the standard error to a point to increase the p-values beyond 0.2, but the groups from the vertical shifting model separate out the individual enough to maintain significance in the odds ratios. 

Figure \ref{fig:6-2} show the clustering results for the three mixture models using maternal BPA exposure during pregnancy as a baseline factor impacts group membership. The chosen number of groups for each model is $K = 5$, $K=4$, and $K=4$ for Model 1, 2, and 3, respectively. The clustering look very similar to those from the models with pre-pregnancy BMI. The main differences occur with Model 1. The group structure is quite different for those with high BMI at age 2.

%%%
Table \ref{tab:6-2} gives the estimated odds ratios comparing group membership for the baseline factor, maternal BPA exposure. In generalizing the correlation structure (Model 2 vs. Model 1), the change of groups change the magnitude of the estimated relationship between BPA and group membership. Suddenly, group 2 compare to group 4 has greater odds when BPA increases. This magnitude shifts is maintained by the vertically shifting model, but the inference changes with a p-value of 0.88 as compared to 0.29. This is largely affected by the increase in the estimated standard error from the group membership changes.

\begin{figure}[h]
\begin{center}
\includegraphics[width=6.5in]{Chp6BMI}
\end{center}
\label{fig:6-1}
\caption{Clustered BMI trajectories colored according to the group assignment made by maximizing the posterior probability and group mean functions for three mixture models with maternal pre-pregnancy BMI as the baseline factor.}
\end{figure}

% latex table generated in R 2.15.2 by xtable 1.7-0 package
% Thu Mar 14 16:06:36 2013
\begin{table}[ht]
\begin{center}
\begin{tabular}{lccc}
  \hline
 & Odds Ratio Estimate & 95\% Confidence Interval & $P>|z|$ \\ 
  \hline
Model 1: Group  1 & 1.32 & (1.2, 1.45) & 0 \\ 
  Model 1: Group  2 & 1.24 & (1.14, 1.35) & 0 \\ 
  Model 1: Group  3 & 1.15 & (1.04, 1.27) & 0.006 \\ 
  Model 1: Group  4 & 1.11 & (1.02, 1.21) & 0.017 \\ 
  Model 1: Group  5  (ref.) & - & - & - \\ 
  Model 2: Group  1 & 1.3 & (0.85, 1.98) & 0.232 \\ 
  Model 2: Group  2 & 1.23 & (0.88, 1.73) & 0.23 \\ 
  Model 2: Group  3 & 1.11 & (0.88, 1.39) & 0.387 \\ 
  Model 2: Group  4  (ref.) & - & - & - \\ 
  Model 3: Group  1 & 1.28 & (0.92, 1.79) & 0.136 \\ 
  Model 3: Group  2 & 1.24 & (0.93, 1.67) & 0.143 \\ 
  Model 3: Group  3 & 1.18 & (0.89, 1.55) & 0.247 \\ 
  Model 3: Group  4 & 1.04 & (0.85, 1.28) & 0.7 \\ 
  Model 3: Group  5  (ref.) & - & - & - \\ 
   \hline
\end{tabular}
\caption{Odds ratio estimates for maternal pre-pregnancy BMI for three mixture models. }
\end{center}
\label{tab:6-1}
\end{table}

\begin{figure}[h]
\begin{center}
\includegraphics[width=6.5in]{Chp6BPA}
\end{center}
\label{fig:6-2}
\caption{Clustered BMI trajectories colored according to the group assignment made by maximizing the posterior probability and group mean functions for three mixture models with maternal pre-pregnancy BMI as the baseline factor.}
\end{figure}

% latex table generated in R 2.15.2 by xtable 1.7-0 package
% Thu Mar 14 16:08:30 2013
\begin{table}[ht]
\begin{center}
\begin{tabular}{lccc}
  \hline
 & Odds Ratio Estimate & 95\% Confidence Interval & $P>|z|$ \\ 
  \hline
Model 1: Group  1 & 0.84 & (0.58, 1.21) & 0.345 \\ 
  Model 1: Group  2 & 0.9 & (0.65, 1.25) & 0.542 \\ 
  Model 1: Group  3 & 1.04 & (0.75, 1.46) & 0.804 \\ 
  Model 1: Group  4 & 0.92 & (0.65, 1.29) & 0.618 \\ 
  Model 1: Group  5  (ref.) & - & - & - \\ 
  Model 2: Group  1 & 0.79 & (0.56, 1.11) & 0.181 \\ 
  Model 2: Group  2 & 1.24 & (0.84, 1.83) & 0.285 \\ 
  Model 2: Group  3 & 1.01 & (0.73, 1.39) & 0.956 \\ 
  Model 2: Group  4  (ref.) & - & - & - \\ 
  Model 3: Group  1 & 0.8 & (0.49, 1.29) & 0.356 \\ 
  Model 3: Group  2 & 1.33 & (0.95, 1.87) & 0.095 \\ 
  Model 3: Group  3 & 1.01 & (0.71, 1.43) & 0.948 \\ 
  Model 3: Group  4 & 0.88 & (0.6, 1.29) & 0.52 \\ 
  Model 3: Group  5  (ref.) & - & - & - \\ 
   \hline
\end{tabular}
\caption{Odds ratio estimates for Log 2 maternal BPA exposure for three mixture models. }
\end{center}
\label{tab:6-2}
\end{table}

\section{Conclusion}
To explore the population in terms of their heterogenous growth patterns over time, we used multivariate finite mixture models. Rather than averaging out all of the interesting growth patterns, mixture models allows for a finite number of relationships. However, mixture models used 'right out of the box' finds these relationships based on the feature that dominate the variability. If this feature is the intercept or vertical level, the estimation of the mixture model may not highlight the patterns over time, which get lost in the groups based on the vertical level (cite my paper). Therefore, we use a simple adjustment to remove the vertical level and only focus on how the children's growth changes over time.

TAKE AWAYS: THE MEAN CURVES MAY NOT DRASTICALLY CHANGE, BUT THE NUMBER OF GROUPS AND THE GROUP MEMBERSHIP DO CHANGE WHICH IMPACTS THE BASELINE FACTOR ESTIMATION. NEED TO SEPARATE THE FACTORS THE IMPACT LEVEL AND THOSE THAT IMPACT SHAPE. 

